<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>QQ表情密文工具</title>
<STYLE type="text/css">
<!--CSS样式代码位置-->
			input{
                border: 1px solid #ccc;
                padding: 7px 0px;
                border-radius: 3px;
                padding-left:5px;
                -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
                box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
                -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
                -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
                transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s
            }
            input:focus{
                    border-color: #66afe9;
                    outline: 0;
                    -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);
                    box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)
            }
</STYLE>
</head>

<body>
<p>QQ表情密文工具  Build001</p>
<textarea type="text" id="av"></textarea><button onclick="return av() && false">加密</button>
<br>
<br>
<textarea type="text" id="bv"></textarea><button onclick="return bv() && false">解密</button>
<p>结果：</p>
<p id="result">(等待输入)</p>
<input id="input">
<button onclick="copyText()">复制</button>
<p>使用方式：</p>
<p>加密：将需要加密的密文（格式见下）填入加密按钮前的输入框，点击加密，再点击复制，然后粘贴到QQ聊天框里自动变成表情</p>
<p>解密：双击QQ里对应密文（即表情符号），按复制，再粘贴到解密按钮前的输入框，点击解密自动出结果</p>
<p>密文要求：仅可使用英文字母，半角符号，不可包含汉字，全角符号等</p>
<p>原理：手机版QQ识别自带表情符号的时候使用的是一个特殊控制字符加一位其他字符的方式，通过组合后一位字符即可实现在一串表情中隐藏密文</p>
<br>
<p>By：<a href="https://space.bilibili.com/229778960" target="_blank">缇雷紫缨</a></p>

<script>
function copyText() {
  var text = document.getElementById("result").innerText;
  var input = document.getElementById("input");
  input.value = text; // 修改文本框的内容
  input.select(); // 选中文本
  document.execCommand("copy"); // 执行浏览器复制命令
  alert("复制成功");
 }

const av2bv = (av) => {
	let num = 'Empty';
	num = av.replace(/([\w \x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])/g, '$1');
    if (av.match(/([][^\w \x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])/g)) {
        return '¿你在想桃子？';
    } else {
        return num;
    };
};

const bv2av = (bv) => {
    let str = 'Empty';
	str = bv.replace(//g, '');
        if (!bv.match(/([][^\w \x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])/g)) {
        return '¿你在想桃子？';
    } else {
        return str;
    };
};

const av = () => {
    let result = av2bv(document.getElementById('av').value);
    document.getElementById('result').innerHTML = `${result}`;
};

const bv = () => {
    let result = bv2av(document.getElementById('bv').value);
    document.getElementById('result').innerHTML = `${result}`;
};

document.getElementById('av').addEventListener('keydown', (event) => {
    if (event.keyCode === 13) {
        av();
    };
});

document.getElementById('bv').addEventListener('keydown', (event) => {
    if (event.keyCode === 13) {
        bv();
    };
});
</script>
</body>
</html>
